import{r as o,T as d,b as e,A as t,j as a}from"./index-BK9-5p3Z.js";const h=()=>{const{global:c,setGlobal:n}=o.useContext(d);o.useState(!1);const[p,S]=o.useState({}),[f,I]=o.useState(!0);o.useEffect(()=>{m()},[]);async function m(){if(localStorage.getItem("method")==="stripe"){const r={subscriberId:localStorage.getItem("stripe"),uid:localStorage.getItem("user"),plan:localStorage.getItem("plan")},g=t+"/api/stripedetails";await e.post(g,r).then(l=>{S(l.data),localStorage.setItem("type",localStorage.getItem("plan")),I(!1)});const s={subscriberId:localStorage.getItem("stripe"),subscription:p.customer.id||"id not found",user:localStorage.getItem("user"),plan:localStorage.getItem("plan"),method:"stripe",fname:localStorage.getItem("fname"),lname:localStorage.getItem("lname"),email:localStorage.getItem("email"),phone:localStorage.getItem("phone"),amount:localStorage.getItem("amount"),course:localStorage.getItem("coursecount"),tax:localStorage.getItem("tax")};if((await e.post(`${t}/api/usersubscription`,s)).status===200){const l={user:localStorage.getItem("user"),count:localStorage.getItem("coursecount")};await e.post(`${t}/api/countplan`,l),localStorage.removeItem("amount"),localStorage.removeItem("coursecount"),localStorage.removeItem("stripe"),localStorage.removeItem("method"),localStorage.removeItem("plan")}const u={user:localStorage.getItem("user"),subject:" Subscription Renewal",description:"Your subscription has been renewed. Enjoy uninterrupted access to Pick My Course."};await e.post(`${t}/api/notify`,u),n(!c)}else try{if(localStorage.getItem("method")==="razorpay"){const r={subscriberId:localStorage.getItem("razorpay"),subscription:localStorage.getItem("subscription"),user:localStorage.getItem("user"),plan:localStorage.getItem("plan"),method:"razorpay",fname:localStorage.getItem("fname"),lname:localStorage.getItem("lname"),email:localStorage.getItem("email"),phone:localStorage.getItem("phone"),amount:localStorage.getItem("amount"),course:localStorage.getItem("coursecount"),tax:localStorage.getItem("tax")};if((await e.post(`${t}/api/usersubscription`,r)).status===200){const i={user:localStorage.getItem("user"),count:localStorage.getItem("coursecount")},u=await e.post(`${t}/api/countplan`,i);localStorage.removeItem("amount"),localStorage.removeItem("coursecount"),localStorage.removeItem("razorpay"),localStorage.removeItem("method"),localStorage.removeItem("plan"),localStorage.removeItem("subscription")}const s={user:localStorage.getItem("user"),subject:" Subscription Renewal",description:"Your subscription has been renewed. Enjoy uninterrupted access to Pick My Course."};await e.post(`${t}/api/notify`,s),n(!c)}}catch{m()}}return a.jsxs("div",{className:"font-poppins font-extralight my-12",children:[a.jsx("p",{className:"text-center text-xl ",children:"Thank You ðŸŽ‰"}),a.jsxs("p",{className:"text-center font-normal text-black py-4 dark:text-white",children:[a.jsx("strong",{children:localStorage.getItem("fname")})," for subscribing to our"," ",a.jsx("strong",{children:localStorage.getItem("plan")})," Plan."," "]})]})};export{h as default};
